{"version":3,"file":"draggify.js","sources":["../src/index.ts"],"sourcesContent":["import Event from 'eventemitter3'\n\nconst event = new Event()\n\nexport function useDrag(target: PIXI.Container) {\n    let isMoving = false\n    let startLocal: any\n    target.interactive = true\n    target.on('touchstart', (e: any) => {\n        isMoving = true\n        startLocal = target.toLocal(e.data.global)\n    })\n    target.on('touchmove', (e: any) => {\n        if (!isMoving) return\n        const position = target.parent?.toLocal(e.data.global)\n        if (position) {\n            target.x = position.x - startLocal.x * target.scale.x\n            target.y = position.y - startLocal.y * target.scale.y\n            // fix pivot offset\n            fix(target)\n        }\n    })\n    target.on('touchend', (e: any) => {\n        isMoving = false\n        event.emit('drop', e)\n    })\n}\n\nexport function useDrop(target: PIXI.Container) {\n    target.interactive = true\n    event.on('drop', (e: any) => {\n        const position = e.data.global\n        const globalPosition = target.parent.toGlobal(target.position)\n        const xOK = position.x > globalPosition.x && position.x < globalPosition.x + target.width\n        const yOK = position.y > globalPosition.y && position.y < globalPosition.y + target.height\n        if (xOK && yOK && target !== e.target) target.emit('drop', e)\n    })\n}\n\nexport default function draggify({ Container }: any) {\n    Container.prototype.draggify = function() {\n        useDrag(this)\n    }\n\n    Container.prototype.droppify = function() {\n        useDrop(this)\n    }\n}\n\nfunction fix(target: any) {\n    target.x += target.pivot.x * target.scale.x\n    target.y += target.pivot.y * target.scale.y\n    if (target.anchor) {\n        target.x += target.width * target.anchor.x\n        target.y += target.height * target.anchor.y\n    }\n}\n"],"names":[],"mappings":"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"}