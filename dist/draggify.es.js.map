{"version":3,"file":"draggify.es.js","sources":["../src/index.ts"],"sourcesContent":["import Event from 'eventemitter3'\n\nconst event = new Event()\n\nexport function useDrag(target: PIXI.Container) {\n    let isMoving = false\n    let startLocal: any\n    target.interactive = true\n    target.on('touchstart', (e: any) => {\n        isMoving = true\n        startLocal = target.toLocal(e.data.global)\n    })\n    target.on('touchmove', (e: any) => {\n        if (!isMoving) return\n        const position = target.parent?.toLocal(e.data.global)\n        if (position) {\n            target.x = position.x - startLocal.x * target.scale.x\n            target.y = position.y - startLocal.y * target.scale.y\n            // fix pivot offset\n            fix(target)\n        }\n    })\n    target.on('touchend', (e: any) => {\n        isMoving = false\n        event.emit('drop', e)\n    })\n}\n\nexport function useDrop(target: PIXI.Container) {\n    target.interactive = true\n    event.on('drop', (e: any) => {\n        const position = e.data.global\n        const globalPosition = target.parent.toGlobal(target.position)\n        const xOK = position.x > globalPosition.x && position.x < globalPosition.x + target.width\n        const yOK = position.y > globalPosition.y && position.y < globalPosition.y + target.height\n        if (xOK && yOK && target !== e.target) target.emit('drop', e)\n    })\n}\n\nexport default function draggify({ Container }: any) {\n    Container.prototype.draggify = function() {\n        useDrag(this)\n    }\n\n    Container.prototype.droppify = function() {\n        useDrop(this)\n    }\n}\n\nfunction fix(target: any) {\n    target.x += target.pivot.x * target.scale.x\n    target.y += target.pivot.y * target.scale.y\n    if (target.anchor) {\n        target.x += target.width * target.anchor.x\n        target.y += target.height * target.anchor.y\n    }\n}\n"],"names":[],"mappings":"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"}