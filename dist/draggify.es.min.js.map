{"version":3,"file":"draggify.es.min.js","sources":["../src/index.ts"],"sourcesContent":["import Event from 'eventemitter3'\n\nconst event = new Event()\n\nexport function useDrag(target: PIXI.Container) {\n    let isMoving = false\n    let startLocal: any\n    target.interactive = true\n    target.on('touchstart', (e: any) => {\n        isMoving = true\n        startLocal = target.toLocal(e.data.global)\n    })\n    target.on('touchmove', (e: any) => {\n        if (!isMoving) return\n        const position = target.parent?.toLocal(e.data.global)\n        if (position) {\n            target.x = position.x - startLocal.x * target.scale.x\n            target.y = position.y - startLocal.y * target.scale.y\n            // fix pivot offset\n            fix(target)\n        }\n    })\n    target.on('touchend', (e: any) => {\n        isMoving = false\n        event.emit('drop', e)\n    })\n}\n\nexport function useDrop(target: PIXI.Container) {\n    target.interactive = true\n    event.on('drop', (e: any) => {\n        const position = e.data.global\n        const globalPosition = target.parent.toGlobal(target.position)\n        const xOK = position.x > globalPosition.x && position.x < globalPosition.x + target.width\n        const yOK = position.y > globalPosition.y && position.y < globalPosition.y + target.height\n        if (xOK && yOK && target !== e.target) target.emit('drop', e)\n    })\n}\n\nexport default function draggify({ Container }: any) {\n    Container.prototype.draggify = function() {\n        useDrag(this)\n    }\n\n    Container.prototype.droppify = function() {\n        useDrop(this)\n    }\n}\n\nfunction fix(target: any) {\n    target.x += target.pivot.x * target.scale.x\n    target.y += target.pivot.y * target.scale.y\n    if (target.anchor) {\n        target.x += target.width * target.anchor.x\n        target.y += target.height * target.anchor.y\n    }\n}\n"],"names":["event","Event","useDrag","target","startLocal","isMoving","interactive","on","e","toLocal","data","global","position","parent","x","scale","y","fix","emit","useDrop","globalPosition","toGlobal","xOK","width","yOK","height","draggify","_a","Container","prototype","droppify","pivot","anchor"],"mappings":"iCAEA,GAAMA,CAAAA,KAAK,CAAG,GAAIC,CAAAA,KAAlB,SAEgBC,CAAAA,QAAQC,MAEhBC,CAAAA,EADAC,CAAQ,IAEZF,CAAM,CAACG,WAAP,IACAH,CAAM,CAACI,EAAP,CAAU,YAAV,CAAwB,SAACC,CAAD,EACpBH,CAAQ,IACRD,CAAU,CAAGD,CAAM,CAACM,OAAP,CAAeD,CAAC,CAACE,IAAF,CAAOC,MAAtB,CAChB,CAHD,EAIAR,CAAM,CAACI,EAAP,CAAU,WAAV,CAAuB,SAACC,CAAD,QACnB,GAAKH,CAAL,EACA,GAAMO,CAAAA,CAAQ,WAAGT,CAAM,CAACU,6BAAQJ,QAAQD,CAAC,CAACE,IAAF,CAAOC,OAA/C,CACIC,CAFJ,GAGIT,CAAM,CAACW,CAAP,CAAWF,CAAQ,CAACE,CAAT,CAAaV,CAAU,CAACU,CAAX,CAAeX,CAAM,CAACY,KAAP,CAAaD,CAHxD,CAIIX,CAAM,CAACa,CAAP,CAAWJ,CAAQ,CAACI,CAAT,CAAaZ,CAAU,CAACY,CAAX,CAAeb,CAAM,CAACY,KAAP,CAAaC,CAJxD,CAMIC,GAAG,CAACd,CAAD,CANP,EAQH,CATD,EAUAA,CAAM,CAACI,EAAP,CAAU,UAAV,CAAsB,SAACC,CAAD,EAClBH,CAAQ,IACRL,KAAK,CAACkB,IAAN,CAAW,MAAX,CAAmBV,CAAnB,CACH,CAHD,CAIH,SAEeW,CAAAA,QAAQhB,GACpBA,CAAM,CAACG,WAAP,IACAN,KAAK,CAACO,EAAN,CAAS,MAAT,CAAiB,SAACC,CAAD,KACPI,CAAAA,CAAQ,CAAGJ,CAAC,CAACE,IAAF,CAAOC,OAClBS,CAAc,CAAGjB,CAAM,CAACU,MAAP,CAAcQ,QAAd,CAAuBlB,CAAM,CAACS,QAA9B,EACjBU,CAAG,CAAGV,CAAQ,CAACE,CAAT,CAAaM,CAAc,CAACN,CAA5B,EAAiCF,CAAQ,CAACE,CAAT,CAAaM,CAAc,CAACN,CAAf,CAAmBX,CAAM,CAACoB,MAC9EC,CAAG,CAAGZ,CAAQ,CAACI,CAAT,CAAaI,CAAc,CAACJ,CAA5B,EAAiCJ,CAAQ,CAACI,CAAT,CAAaI,CAAc,CAACJ,CAAf,CAAmBb,CAAM,CAACsB,OAChFH,CAAG,EAAIE,CAAP,EAAcrB,CAAM,GAAKK,CAAC,CAACL,QAAQA,CAAM,CAACe,IAAP,CAAY,MAAZ,CAAoBV,CAApB,CAC1C,CAND,CAOH,SAEuBkB,CAAAA,SAASC,MAAEC,CAAAA,cAC/BA,CAAS,CAACC,SAAV,CAAoBH,QAApB,CAA+B,WAC3BxB,OAAO,CAAC,IAAD,CACV,EAED0B,CAAS,CAACC,SAAV,CAAoBC,QAApB,CAA+B,WAC3BX,OAAO,CAAC,IAAD,CACV,CACJ,CAED,QAASF,CAAAA,GAAT,CAAad,CAAb,EACIA,CAAM,CAACW,CAAP,EAAYX,CAAM,CAAC4B,KAAP,CAAajB,CAAb,CAAiBX,CAAM,CAACY,KAAP,CAAaD,EAC1CX,CAAM,CAACa,CAAP,EAAYb,CAAM,CAAC4B,KAAP,CAAaf,CAAb,CAAiBb,CAAM,CAACY,KAAP,CAAaC,EACtCb,CAAM,CAAC6B,SACP7B,CAAM,CAACW,CAAP,EAAYX,CAAM,CAACoB,KAAP,CAAepB,CAAM,CAAC6B,MAAP,CAAclB,EACzCX,CAAM,CAACa,CAAP,EAAYb,CAAM,CAACsB,MAAP,CAAgBtB,CAAM,CAAC6B,MAAP,CAAchB,EAEjD"}