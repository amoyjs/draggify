{"version":3,"file":"draggify.min.js","sources":["../src/index.ts"],"sourcesContent":["import Event from 'eventemitter3'\n\nconst event = new Event()\n\nexport function useDrag(target: PIXI.Container) {\n    let isMoving = false\n    let startLocal: any\n    target.interactive = true\n    target.on('touchstart', (e: any) => {\n        isMoving = true\n        startLocal = target.toLocal(e.data.global)\n    })\n    target.on('touchmove', (e: any) => {\n        if (!isMoving) return\n        const position = target.parent?.toLocal(e.data.global)\n        if (position) {\n            target.x = position.x - startLocal.x * target.scale.x\n            target.y = position.y - startLocal.y * target.scale.y\n            // fix pivot offset\n            fix(target)\n        }\n    })\n    target.on('touchend', (e: any) => {\n        isMoving = false\n        event.emit('drop', e)\n    })\n}\n\nexport function useDrop(target: PIXI.Container) {\n    target.interactive = true\n    event.on('drop', (e: any) => {\n        const position = e.data.global\n        const globalPosition = target.parent.toGlobal(target.position)\n        const xOK = position.x > globalPosition.x && position.x < globalPosition.x + target.width\n        const yOK = position.y > globalPosition.y && position.y < globalPosition.y + target.height\n        if (xOK && yOK && target !== e.target) target.emit('drop', e)\n    })\n}\n\nexport default function draggify({ Container }: any) {\n    Container.prototype.draggify = function() {\n        useDrag(this)\n    }\n\n    Container.prototype.droppify = function() {\n        useDrop(this)\n    }\n}\n\nfunction fix(target: any) {\n    target.x += target.pivot.x * target.scale.x\n    target.y += target.pivot.y * target.scale.y\n    if (target.anchor) {\n        target.x += target.width * target.anchor.x\n        target.y += target.height * target.anchor.y\n    }\n}\n"],"names":["useDrag","target","startLocal","isMoving","interactive","on","e","toLocal","data","global","position","parent","x","scale","y","fix","event","emit","useDrop","globalPosition","toGlobal","xOK","width","yOK","height","pivot","anchor","Event","_a","Container","prototype","draggify","droppify"],"mappings":"mQAIgBA,CAAAA,EAAQC,MAEhBC,CAAAA,EADAC,CAAQ,IAEZF,CAAM,CAACG,WAAP,IACAH,CAAM,CAACI,EAAP,CAAU,YAAV,CAAwB,SAACC,CAAD,EACpBH,CAAQ,IACRD,CAAU,CAAGD,CAAM,CAACM,OAAP,CAAeD,CAAC,CAACE,IAAF,CAAOC,MAAtB,CAChB,CAHD,EAIAR,CAAM,CAACI,EAAP,CAAU,WAAV,CAAuB,SAACC,CAAD,QACnB,GAAKH,CAAL,EACA,GAAMO,CAAAA,CAAQ,WAAGT,CAAM,CAACU,6BAAQJ,QAAQD,CAAC,CAACE,IAAF,CAAOC,OAA/C,CACIC,CAFJ,GAGIT,CAAM,CAACW,CAAP,CAAWF,CAAQ,CAACE,CAAT,CAAaV,CAAU,CAACU,CAAX,CAAeX,CAAM,CAACY,KAAP,CAAaD,CAHxD,CAIIX,CAAM,CAACa,CAAP,CAAWJ,CAAQ,CAACI,CAAT,CAAaZ,CAAU,CAACY,CAAX,CAAeb,CAAM,CAACY,KAAP,CAAaC,CAJxD,CAMIC,CAAG,CAACd,CAAD,CANP,EAQH,CATD,EAUAA,CAAM,CAACI,EAAP,CAAU,UAAV,CAAsB,SAACC,CAAD,EAClBH,CAAQ,IACRa,CAAK,CAACC,IAAN,CAAW,MAAX,CAAmBX,CAAnB,CACH,CAHD,CAIH,SAEeY,CAAAA,EAAQjB,GACpBA,CAAM,CAACG,WAAP,IACAY,CAAK,CAACX,EAAN,CAAS,MAAT,CAAiB,SAACC,CAAD,KACPI,CAAAA,CAAQ,CAAGJ,CAAC,CAACE,IAAF,CAAOC,OAClBU,CAAc,CAAGlB,CAAM,CAACU,MAAP,CAAcS,QAAd,CAAuBnB,CAAM,CAACS,QAA9B,EACjBW,CAAG,CAAGX,CAAQ,CAACE,CAAT,CAAaO,CAAc,CAACP,CAA5B,EAAiCF,CAAQ,CAACE,CAAT,CAAaO,CAAc,CAACP,CAAf,CAAmBX,CAAM,CAACqB,MAC9EC,CAAG,CAAGb,CAAQ,CAACI,CAAT,CAAaK,CAAc,CAACL,CAA5B,EAAiCJ,CAAQ,CAACI,CAAT,CAAaK,CAAc,CAACL,CAAf,CAAmBb,CAAM,CAACuB,OAChFH,CAAG,EAAIE,CAAP,EAActB,CAAM,GAAKK,CAAC,CAACL,QAAQA,CAAM,CAACgB,IAAP,CAAY,MAAZ,CAAoBX,CAApB,CAC1C,CAND,CAOH,CAYD,QAASS,CAAAA,CAAT,CAAad,CAAb,EACIA,CAAM,CAACW,CAAP,EAAYX,CAAM,CAACwB,KAAP,CAAab,CAAb,CAAiBX,CAAM,CAACY,KAAP,CAAaD,EAC1CX,CAAM,CAACa,CAAP,EAAYb,CAAM,CAACwB,KAAP,CAAaX,CAAb,CAAiBb,CAAM,CAACY,KAAP,CAAaC,EACtCb,CAAM,CAACyB,SACPzB,CAAM,CAACW,CAAP,EAAYX,CAAM,CAACqB,KAAP,CAAerB,CAAM,CAACyB,MAAP,CAAcd,EACzCX,CAAM,CAACa,CAAP,EAAYb,CAAM,CAACuB,MAAP,CAAgBvB,CAAM,CAACyB,MAAP,CAAcZ,EAEjD,iDAtDD,GAAME,CAAAA,CAAK,CAAG,GAAIW,CAAAA,CAAlB,oBAqCiCC,MAAEC,CAAAA,cAC/BA,CAAS,CAACC,SAAV,CAAoBC,QAApB,CAA+B,WAC3B/B,CAAO,CAAC,IAAD,CACV,EAED6B,CAAS,CAACC,SAAV,CAAoBE,QAApB,CAA+B,WAC3Bd,CAAO,CAAC,IAAD,CACV,CACJ"}